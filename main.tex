\documentclass[12pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{amsmath, amssymb, amsthm}

\usepackage[a4paper,margin=2.5cm]{geometry}
\usepackage{hyperref}

\usepackage{listings}
\lstset{
  basicstyle=\ttfamily\small,
  breaklines=true,
  columns=fullflexible,
  frame=single
}

\newtheorem{theorem}{Теорема}
\newtheorem{lemma}{Лемма}
\newtheorem{definition}{Определение}
\newtheorem{proposition}{Утверждение}
\newtheorem{corollary}{Следствие}

\newcommand{\VCk}{\mathrm{VC}_k}
\newcommand{\AVCk}{\mathrm{AVC}_k}
\newcommand{\VCFk}{\mathrm{VCF}_k}
\newcommand{\CVCFk}{\mathrm{cVCF}_k}
\newcommand{\AVCFk}{\mathrm{AVCF}_k}

\title{Запрещённые миноры для свойства Almost Vertex Covered}
\author{Шарыпов Егор}

\begin{document}
\maketitle

\begin{abstract}

Задача о вершинном покрытии является одной из классических $\mathbf{NP}$-полных задач, однако при фиксированном размере покрытия существует конечный список запрещённых миноров, отсутствием которых в графе определяется это свойство. В данной работе мы найдём списки запрещённых миноров для размеров покрытия от 1 до 6. Впервые список запрещённых миноров будет найден для следующей модификации этого свойства: при удалении любого ребра существует вершинное покрытие размера $k$, где $k$ также от 1 до 6.

\end{abstract}

\section{Введение}

Будем называть граф $H$ минором графа $G$ (и писать $H \le_m G$), если $H$ можно получить из $G$ цепочкой (возможно пустой) из следующих действий:

\begin{enumerate}
\item Удаление ребра
\item Удаление вершины
\item Стягивание ребра
\end{enumerate}

Будем называть свойство графов $\mathcal{A}$ замкнутым относительно взятия миноров, если $\forall G \in \mathcal{A} \forall H(H \le_m G \Rightarrow H\in\mathcal{A})$.

Теорема Робертсона-Сеймура \cite{robertson-seymour} гласит, что для любого замкнутого относительно взятия миноров свойства существует конечный список запрещённых миноров, отсутствие которых в графе равносильно наличию этого свойства. Причём эти запрещённые миноры -- это в точности те графы, которые сами не обладают заданным свойстом, но любой их минор будет обладать этим свойством.

К сожалению, доказательство теоремы не конструктивно, и поэтому списки запрещённых миноров для многих свойств остаются открытыми проблемами.

В этой работе нас будут интересовать свойства, связанные с вершинным покрытием. Вершинное покрытие графа -- подмножество вершин, такое, что любое ребро графа инцидентно некоторой вершине покрытия.

Введём обозначения:

$\tau(G)$ -- минимальный из размеров вершинных покрытий

$G-ab, ab\in E(G)$ -- граф, полученный из $G$ удалением ребра $ab$

$G/ab, ab\in E(G)$ -- граф, полученный из $G$ стягиванием ребра $ab$

$G-v, v \in V(G)$ -- граф, полученный из $G$ удалением вершины $v$

$\VCk=\left\{G \mid \tau(G) \le k\right\}$

$\AVCk = \left\{G \mid \forall e \in E(G): (G - e) \in \VCk\right\}$

$\VCFk$ и $\AVCFk$ -- множества запрещённых миноров для $\VCk$ и $\AVCk$ соответственно.

$\CVCFk = \left\{G \in \VCFk \mid G - \text{связен}\right\}$

Поясним выбор некоторых названий: VC значит Vertex Covered, AVC значит Almost Vertex Covered, суффикс F - Forbidden, а префикс c - connected.

Мы имеем право говорить о множествах запрещённых миноров для свойств $\VCk$ и $\AVCk$ ввиду следующей леммы:

\begin{lemma}

Свойства $\VCk$ и $\AVCk$ замкнуты относительно взятия миноров

\end{lemma}

\begin{proof}

Сначала докажем для $\VCk$. Пусть $G \in \VCk$ (есть покрытие из $\le k$ вершин), а $H$ получен путём

\begin{itemize}
    \item Удаления ребра: тогда достаточно взять то же самое вершинное покрытие

    \item Удаления вершины: пересекаем старое покрытие с новым множеством вершин -- размер покрытия не увеличится, а все рёбра, инцидентные новым вершинам, мы из $H$ выкидываем

    \item Стягиванием ребра: если стягиваемое ребро было инцидентно вершине из покрытия, то добавляем новую вершину в покрытие, иначе оставляем покрытие как есть. Очевидно, полученное таким образом покрытие будет покрытием $H$.
\end{itemize}

В замкнутости относительно взятия миноров свойства $\AVCk$ также нетрудно убедиться.

\end{proof}

Знание таких списков запрещённых миноров важно, потому что позволяет создавать сертификаты не-принадлежности к заданному семейству: достаточно указать присутствующий запрещённый минор из списка и последовательность действий, которая позволяет его получить.

В этой работе были получены списки $\AVCFk$ и $\VCFk$ для $k \le 6$. В то время как $\VCFk$ при тех же $k$ -- уже известный результат (\cite{dinneen-xiong}), нам не удалось найти опубликованный список $\AVCFk$.

В ходе этой работы сначала были получены списки связных запрещённых миноров для $\VCk$, потом были получены $\VCFk$, потом на их основании были с помощью добавления рёбер были получены $\AVCFk$.

Размеры найденных множеств приведены в таблице \ref{tab:sz}.

\begin{table}[ht]
\caption{Размеры найденных множеств}
\begin{center}
\begin{tabular}{c|c|c|c}
$k$ & $|\CVCFk|$ & $|\VCFk|$ & $|\AVCFk|$\\
\hline
0 & 1 & 1 & 2\\
1 & 1 & 2 & 3\\
2 & 2 & 4 & 5\\
3 & 3 & 8 & 12\\
4 & 8 & 18 & 36\\
5 & 31 & 56 & 174\\
6 & 188 & 260 & 1478\\
\end{tabular}
\end{center}
\label{tab:sz}
\end{table}

С текстом исходного кода и с полученными списками запрещённых миноров можно ознакомиться в репозитории \cite{repo}. Найденные графы для $k=4$ также приведены в заключении.

\section{Поиск $\CVCFk$}

Как мы увидим позже, все элементы $\VCFk$ довольно просто строятся из связных компонент, поэтому оправданно сначала найти связные компоненты отдельно.

Наша общая стратегия для поиска связных запрещённых миноров будет такой: сначала получим факты о виде графов из $\CVCFk$, которые позволят ограничить перебор, а потом переберём оставшиеся графы и в лоб проверим, подходят они или нет. Факты, как и сама процедура поиска $\VCFk$, заимствованы из \cite{dinneen-xiong} и \cite{dinneen-lai2007}.

Начнём с того, что построим следующий удобный критерий $\VCFk$:

\begin{theorem}
Пусть $k\ge 0$ и $G$ --- граф без изолированных вершин.
Тогда следующие условия эквивалентны:

\begin{enumerate}
  \item $G\in \VCFk$;
  \item $\tau(G)=k+1$ и для любого ребра $e\in E(G)$ выполнено $\tau(G-e)=k$.
\end{enumerate}

\end{theorem}

\begin{proof}

Докажем $(1)\Rightarrow(2)$.
Пусть $G\in \VCFk$.
Тогда $\tau(G)>k$. Покажем, что на самом деле $\tau(G)=k+1$.
Предположим противное: $\tau(G)\ge k+2$. Возьмём любую вершину $v\in V(G)$.
Тогда для графа $G-v$ верно
\[
\tau(G-v)\ \ge\ \tau(G)-1\ \ge\ k+1,
\]
поскольку любое вершинное покрытие графа $G-v$ можно расширить до покрытия $G$,
добавив вершину $v$ (то есть $\tau(G)\le \tau(G-v)+1$).
Следовательно, $\tau(G-v)>k$, то есть строгий минор $G-v$ не принадлежит $VC_k$,
что противоречит минимальности $G$ по минорам. Значит $\tau(G)=k+1$.

Теперь возьмём произвольное ребро $e\in E(G)$. Граф $G-e$ является строгим минором $G$,
поэтому по определению $\VCFk$ имеем $\tau(G-e)\le k$.
С другой стороны, всегда верно неравенство
\[
\tau(G)\ \le\ \tau(G-e)+1,
\]
потому что любое вершинное покрытие $S$ графа $G-e$ можно превратить
в вершинное покрытие графа $G$, добавив один из концов ребра $e$.
Отсюда при $\tau(G)=k+1$ получаем $\tau(G-e)\ge k$.

Докажем $(2)\Rightarrow(1)$.
Пусть $\tau(G)=k+1$ и $\tau(G-e)=k$ для всех $e\in E(G)$.
Тогда $\tau(G)>k$, то есть $G\notin \VCk$.
Осталось показать минор-минимальность: любой строгий минор $H <_m G$ лежит в $\VCk$.

\begin{enumerate}

\item Удаление ребра.
По условию для любого ребра $e$ уже имеем $\tau(G-e)=k$, то есть $G-e\in \VCk$.

\item Удаление вершины.
Пусть $v\in V(G)$. Поскольку в $G$ нет изолированных вершин, существует ребро $e$,
инцидентное $v$. Тогда $G-v$ является минором графа $G-e$ (достаточно удалить вершину $v$
после удаления ребра $e$), то есть $G-v \le_m G-e$.
Так как $\tau$ не возрастает при переходе к минорам, получаем
\[
\tau(G-v)\ \le\ \tau(G-e)\ =\ k.
\]
Значит $G-v\in \VCk$.

\item{Стягивание ребра.}
Пусть $e \in E(G)$ и рассмотрим $G/e$.
Заметим, что $\tau (G/e) \le \tau(G - e) = k$, ведь вершинное покрытие $G - e$ можно перенести на вершинное покрытие $G/e$, т.е. $G/e \in \VCk$

\end{enumerate}

Получили, что строгие миноры $G$ лежат в $\VCk$, то есть $G \in \VCFk$

\end{proof}

Теперь докажем, что графы из $\CVCFk$ двусвязны, то есть не имеют точек сочленения

\begin{lemma}

Любой связный запрещённый минор $G$ двусвязен.

\end{lemma}

\begin{proof}

Пусть $G \in \CVCFk$, $v$ - точка сочленения $G$. Обозначим как $C_i$ компоненты, на которые распадается $G - v$, и как $C'_i$ индуцированные подграфы на $C_i \cup \{v\}$. $\bigcup C_i$ -- собственный минор $G$ полученный путём удаления $v$, а значит $\sum \tau(C_i) = k$. При этом $\sum \tau(C'_i) \ge \tau(G) = k+1$, а значит для некоторого $i$ выполнено $\tau(C'_i) = \tau(C_i)+1$. Получается, что $\sum\limits_{j \ne i} \tau(C_j) + \tau(C_i) = k+1$, а это собственный минор -- противоречие.

\end{proof}

Также приведём без доказательства два важных утверждения, которые помогают ограничить поиск запрещённых миноров. За доказательством этих утверждений можно обратиться к \cite{dinneen-lai2007} и \cite{dinneen-xiong}.

\begin{proposition}

Количество вершин графа из $\CVCFk$ не превосходит $2k+1$.

\end{proposition}

\begin{proposition}

Степени вершин графов из $\CVCFk$ не превосходят $2k-n+3$, где $n$ - количество вершин.

\end{proposition}

Опишем теперь на псевдокоде алгоритм, который использовался для поиска $\CVCFk$:

\begin{lstlisting}
def is_vcf(G):
    if tau(G) <= k:
        return false

    for e in E(G):
        if not tau(G - e) <= k:
            return false

    return true

result = []

for n in {k+1, ..., 2k+1}:
    for G in BiconGraphs(n, d=2k-n+3):
        if is_vcf(G):
            result.append(G)
\end{lstlisting}

Здесь $\text{BiconGraphs}(n, d)$ - это двусвязные графы на $n$ вершинах, где степень не превосходит $d$. 

Детали реализации: код написан на Python с использованием библиотеки networkx \cite{networkx}. Перебор неизоморфных двусвязных графов с ограничением на степень был использован готовый из пакета nauty \cite{nauty}. Проверки вида $\tau(G) \le k$ осуществляются так: мы перебором/поиском в глубину рекурсивно пытаемся выбрать один из концов ребра в подпокрытие. Дополнительно используется наблюдение о том, что если $\text{deg} (v) > k$, то $v$ точно будет в покрытии.

\section{Вычисление несвязных запрещённых миноров}

Начнём с леммы, которая описывает, как выглядят несвязные запрещённые миноры.

\begin{lemma}
Пусть $O \in \VCFk$ и $O$ несвязен. Тогда $O = \bigsqcup\limits_{j=1}^s O_j$,
где каждый $O_j$ --- связные запрещённые миноры для некоторого $p_j$,
то есть $O_j\in \mathrm{cVCF}_{p_j}$, и выполняется баланс:
\[
\sum_{j=1}^s (p_j+1)=k+1.
\]
\end{lemma}

\begin{proof}

Для несвязного графа вершинное покрытие аддитивно по компонентам:
$\tau(\bigsqcup_j G_j)=\sum_j \tau(G_j)$.

Так как $O\in\VCFk$, то $\tau(O)=k+1$ и удаление любого ребра уменьшает $\tau$ на $1$.
Выбирая ребро внутри компоненты $O_j$, видим, что именно в этой компоненте покрытие уменьшается на $1$,
а остальные компоненты не меняются. Значит каждая компонента $O_j$ сама является запрещённым минором некоторого уровня $p_j=\tau(O_j)-1$.

Суммируя $\tau(O)=\sum_j \tau(O_j)=k+1$, получаем требуемое равенство
$\sum_j(p_j+1)=k + 1$.

\end{proof}

Таким образом, чтобы найти несвязные запрещённые миноры, нужно перебрать все разбиения $k+1$ на слагаемые, и для каждого слагаемого в разбиении подобрать уже известный связный запрещённый минор.

Отметим, что по итогу этого вычисления найденное количество миноров сошлось с результатами \cite{dinneen-xiong}.

\section{Вычисление $\AVCFk$}

На высоком уровне алгоритм, вычисляющий $\AVCFk$, работает так: сначала создаётся список кандидатов, полученных всевозможными добавлениями рёбер к элементам $\VCFk$, потом фильтруются неизоморфные, потом в лоб проверяется принадлежность $\AVCFk$.

Формализуем и обоснуем процедуру добавки рёбер к минорам из $\VCFk$ следующей теоремой.

\begin{theorem}

Для любого графа $H$ из $\AVCFk$ существует граф $G$ из $\VCFk$ такой, что $H$ можно получить из $G$ выполнением одной из трёх операций: соединение пары вершин ребром, добавление ребра, прикреплённого к $G$, или добавление не пересекающегося с $G$ ребра.

\end{theorem}

\begin{proof}

Пусть $H\in \AVCFk$. Тогда $H\notin\AVCk$, значит существует ребро $e$ такое, что $\tau(H-e) \ge k+1$.
Обозначим $G=H-e$. Так как $G$ -- собственный минор $H$, по минимальности $H$ имеем $G\in\AVCk$.
В частности, для всех рёбер $f\in E(G)$ выполнено $\tau(G-f)\le k$.
Пусть $G'$ -- это $G$, из которого выкинули все изолированные вершины. Для $G'$ выполнено, что $\tau(G') = \tau(G) \ge k+1$. Однако $G' <_m H$, значит $G' \in \AVCk$, и после удаления любого ребра появится покрытие $k$ вершинами. $\tau(G') = k+1$, а значит по критерию $\VCFk$ получаем $G' \in \VCFk$.

Граф $H$ мог быть получен из $G'$ путём добавления изолированных вершин и ребра, то есть одним из трёх указанных действий.

\end{proof}

Отметим, что это не критерий: например, $K_3\sqcup K_2 \in \mathrm{VCF}_2$, но если соединить эти две компоненты ребром, то полученный граф не будет в $\mathrm{AVCF_2}$, ведь после удаления ребра из треугольника останется $P_4 \in \mathrm{VC}_2$.

Для проверки $G \in \AVCk$ перебирались все рёбра и проверялось $G-e\in \VCk$. Проверка $G \in \AVCFk$ выражалась через проверки $G \notin \AVCk$ и $\forall H<_mG: H \in \AVCk$.

Для фильтрации неизоморфных графов использовался тот же пакет nauty \cite{nauty}.

\section{Вывод}

В ходе проекта реализован вычислительный пайплайн для списков запрещённых миноров $\CVCFk$, $\VCFk$ и $\AVCFk$. На практике он применим для вычислений для небольших $k$ ввиду экспоненциально растущих временных затрат. Пайплайн был применён экспериментально для вычислений запрещённых миноров для $k \le 6$. Материалы для воспроизведения можно найти в репозитории \cite{repo}. Ниже приведена диаграмма с найденными запрещёнными минорами для $k=4$.

\begin{figure}[h]
\centering
\resizebox{\textwidth}{!}{\input{figs/avcf4_grid.tex}}
\caption{Все графы из $\mathrm{AVCF}_4$}
\end{figure}

\begin{figure}[h]
\centering
\resizebox{\textwidth}{!}{\input{figs/vcf4_grid.tex}}
\caption{Все графы из $\mathrm{VCF}_4$}
\end{figure}

\section*{Ссылки}
\begin{thebibliography}{9}

\bibitem{dinneen-lai2007}
M. J. Dinneen, R. Lai.
\newblock Properties of vertex cover obstructions.
\newblock \emph{Discrete Mathematics}
\url{https://www.cs.auckland.ac.nz/~mjd/vacs/VCproperties.pdf}

\bibitem{networkx}

Библиотека для работы с графами NetworkX

\newblock \url{https://networkx.org/en/}

\bibitem{dinneen-xiong}
M. J. Dinneen, L. Xiong.
\newblock The Minor-Order Obstructions for The Graphs of Vertex Cover Six
\newblock \emph{Discrete Mathematics}.

\url{https://www.cs.auckland.ac.nz/research/groups/CDMTCS/researchreports/118vc6.pdf}

\bibitem{robertson-seymour}
N. Robertson, P. D. Seymour.
\newblock Graph Minors.
\newblock \emph{Серия статей}, 1983--2004.

\bibitem{nauty}
McKay, B. D. and Piperno, A.
\newblock Practical Graph Isomorphism, II
\newblock Journal of Symbolic Computation, 60 (2014), pp. 94-112.

\bibitem{repo}

Репозиторий с текстом исходного кода и полученными списками запрещённых миноров

\url{https://github.com/koldun256/vertex_cover}

\end{thebibliography}

\end{document}
